Wave function analysis and single-electron properties
===========================================================

The wave function analyses supported by the BDF are: Mulliken and Lowdin Boolean analysis, including net atomic charge and spin density.

.. _1e-prop:

The single-electron properties supported by the BDF are:

* SCF：dipole moment, polarizability*, hyperpolarizability*, Musburger spectrum (effective contact density), NMR\*\*
* TDDFT：dipole moment of excited states*, vibronic intensity of fluorescence absorption spectra, vibronic intensity of phosphorescence absorption spectra

  \* Calculated in ``resp`` module. \*\* Calculated in ``nmr`` module

More wave function analysis and single electron properties can be done by generating data files in molden format in the ``scf`` module with a third party program This is done. Example input.

.. code-block:: bdf

  $scf
  rks
  dft
   b3lyp
  molden
  $end

The standard molden format only supports spdfg-type Gaussian basis functions, but has been extended to h-functions in BDF

Effective contact density
------------------------------------------------

The calculation of the effective contact density (ED) requires consideration of
both relativistic effects (X2C Hamiltonian in BDF, identified by ``heff`` = 21, 22,
or 23) and finite size nuclei ( ``nuclear`` = 1). An example input at the sf-X2CAU/B3LYP level is as follows

.. code-block:: bdf

  $xuanyuan
   heff
    23
   nuclear
    1
  $end

  $scf
   rks
   dft
    b3lyp
   grid
    sg1
   reled
    20
  $end

where ``reled`` calls the calculation of the relativistic property ED. ``20`` means that the ED is not calculated for light elements with atomic number less than 20, thus
saving calculation time. For density generalization calculations, the value of ED is sensitive to the integration grid point and ``ultra fine`` or more precise ``sg1`` is recommended.


The ED requires a special treatment of the basis group, see  :ref:`穆斯堡尔谱<mossbauer>` .

molden2aim
------------------------------------------------
Download: https://github.com/zorkzou/Molden2AIM

The purpose of molden2aim is to convert molden files generated by BDF into wfn, wfx, or NBO-47 format data files for various various analyses. It supports spdfghtype Gaussian basis functions as well as ECP.

Multiwfn
------------------------------------------------
Download: http://sobereva.com/multiwfn/

Multiwfn is a powerful wave function analysis program. Molden data files (supporting spdfgh basis functions and pseudopotentials) generated by BDF or wfn, wfx data files transformed by molden2aim, Multiwfn can be used for various wave
function analyses, such as electron density topology analysis (also known as *quantum theory of atoms in molecules* ; QTAIM), electron localization functions
(ELF), booster analysis, bond level analysis, atomic charge analysis, etc., and Images of molecular orbitals, electron density and various real space functions
can also be plotted. See the Multiwfn user manual for details.


NBO analysis
------------------------------------------------
BDF does not currently contain an interface to NBO (https://nbo7.chem.wisc.edu/),
but it is possible to use molden2aim to convert BDF-generated molden files
(supporting spdfgh basis functions and pseudopotentials) into NBO-47 format data
files, and then use the NBO standalone program gennbo.exe to perform NBO analysis.

For wave functions of the RHF/RKS and UHF/UKS types (i.e., the MO occupation
number can only be 0, 1, and 2), NBO can calculate the "Second Order Perturbation
Theory Analysis", which requires the presence of the Fock matrix in the 47 file.
To do this, set ``nbopro=1`` in the molden2aim configuration file ``m2a.ini`` .


